{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar gsheetsapi_js_1 = __importDefault(require(\"./gsheetsapi.js\"));\nfunction matchValues(valToMatch, valToMatchAgainst, matchingType) {\n  try {\n    if (typeof valToMatch != 'undefined') {\n      valToMatch = valToMatch.toLowerCase().trim();\n      valToMatchAgainst = valToMatchAgainst.toLowerCase().trim();\n      if (matchingType === 'strict') {\n        return valToMatch === valToMatchAgainst;\n      }\n      if (matchingType === 'loose') {\n        return valToMatch.includes(valToMatchAgainst) || valToMatch == valToMatchAgainst;\n      }\n    }\n  } catch (e) {\n    console.log(\"error in matchValues: \".concat(e.message));\n    return false;\n  }\n  return false;\n}\nfunction filterResults(resultsToFilter, filter, options) {\n  var filteredData = [];\n  // now we have a list of rows, we can filter by various things\n  return resultsToFilter.filter(function (item) {\n    // item data shape\n    // item = {\n    //   'Module Name': 'name of module',\n    //   ...\n    //   Department: 'Computer science'\n    // }\n    var addRow = null;\n    var filterMatches = [];\n    if (typeof item === 'undefined' || item.length <= 0 || Object.keys(item).length <= 0) {\n      return false;\n    }\n    Object.keys(filter).forEach(function (key) {\n      var filterValue = filter[key]; // e.g. 'archaeology'\n      // need to find a matching item object key in case of case differences\n      var itemKey = Object.keys(item).find(function (thisKey) {\n        return thisKey.toLowerCase().trim() === key.toLowerCase().trim();\n      });\n      var itemValue = item[itemKey]; // e.g. 'department' or 'undefined'\n      filterMatches.push(matchValues(itemValue, filterValue, options.matching || 'loose'));\n    });\n    if (options.operator === 'or') {\n      addRow = filterMatches.some(function (match) {\n        return match === true;\n      });\n    }\n    if (options.operator === 'and') {\n      addRow = filterMatches.every(function (match) {\n        return match === true;\n      });\n    }\n    return addRow;\n  });\n}\nfunction processGSheetResults(JSONResponse, returnAllResults, filter, filterOptions) {\n  var data = JSONResponse.values;\n  var startRow = 1; // skip the header row(1), don't need it\n  var processedResults = [{}];\n  var colNames = {};\n  for (var i = 0; i < data.length; i++) {\n    // Rows\n    var thisRow = data[i];\n    for (var j = 0; j < thisRow.length; j++) {\n      // Columns/cells\n      var cellValue = thisRow[j];\n      var colNameToAdd = colNames[j]; // this will be undefined on the first pass\n      if (i < startRow) {\n        colNames[j] = cellValue;\n        continue; // skip the header row\n      }\n\n      if (typeof processedResults[i] === 'undefined') {\n        processedResults[i] = {};\n      }\n      if (typeof colNameToAdd !== 'undefined' && colNameToAdd.length > 0) {\n        processedResults[i][colNameToAdd] = cellValue;\n      }\n    }\n  }\n  // make sure we're only returning valid, filled data items\n  processedResults = processedResults.filter(function (result) {\n    return Object.keys(result).length;\n  });\n  // if we're not filtering, then return all results\n  if (returnAllResults || !filter) {\n    return processedResults;\n  }\n  return filterResults(processedResults, filter, filterOptions);\n}\nvar gsheetProcessor = function (options, callback, onError) {\n  var apiKey = options.apiKey,\n    sheetId = options.sheetId,\n    sheetName = options.sheetName,\n    sheetNumber = options.sheetNumber,\n    returnAllResults = options.returnAllResults,\n    filter = options.filter,\n    filterOptions = options.filterOptions;\n  if (!options.apiKey || options.apiKey === undefined) {\n    throw new Error('Missing Sheets API key');\n  }\n  return (0, gsheetsapi_js_1.default)({\n    apiKey: apiKey,\n    sheetId: sheetId,\n    sheetName: sheetName,\n    sheetNumber: sheetNumber\n  }).then(function (result) {\n    var filteredResults = processGSheetResults(result, returnAllResults || false, filter || false, filterOptions || {\n      operator: 'or',\n      matching: 'loose'\n    });\n    callback(filteredResults);\n  }).catch(function (err) {\n    return onError(err.message);\n  });\n};\nexports.default = gsheetProcessor;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","gsheetsapi_js_1","require","matchValues","valToMatch","valToMatchAgainst","matchingType","toLowerCase","trim","includes","e","console","log","concat","message","filterResults","resultsToFilter","filter","options","filteredData","item","addRow","filterMatches","length","keys","forEach","key","filterValue","itemKey","find","thisKey","itemValue","push","matching","operator","some","match","every","processGSheetResults","JSONResponse","returnAllResults","filterOptions","data","values","startRow","processedResults","colNames","i","thisRow","j","cellValue","colNameToAdd","result","gsheetProcessor","callback","onError","apiKey","sheetId","sheetName","sheetNumber","undefined","Error","default","then","filteredResults","catch","err"],"sources":["/home/paulocamara/Desktop/rolezando-por-ai/node_modules/g-sheets-api/build/gsheetsprocessor.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gsheetsapi_js_1 = __importDefault(require(\"./gsheetsapi.js\"));\nfunction matchValues(valToMatch, valToMatchAgainst, matchingType) {\n    try {\n        if (typeof valToMatch != 'undefined') {\n            valToMatch = valToMatch.toLowerCase().trim();\n            valToMatchAgainst = valToMatchAgainst.toLowerCase().trim();\n            if (matchingType === 'strict') {\n                return valToMatch === valToMatchAgainst;\n            }\n            if (matchingType === 'loose') {\n                return (valToMatch.includes(valToMatchAgainst) ||\n                    valToMatch == valToMatchAgainst);\n            }\n        }\n    }\n    catch (e) {\n        console.log(\"error in matchValues: \".concat(e.message));\n        return false;\n    }\n    return false;\n}\nfunction filterResults(resultsToFilter, filter, options) {\n    var filteredData = [];\n    // now we have a list of rows, we can filter by various things\n    return resultsToFilter.filter(function (item) {\n        // item data shape\n        // item = {\n        //   'Module Name': 'name of module',\n        //   ...\n        //   Department: 'Computer science'\n        // }\n        var addRow = null;\n        var filterMatches = [];\n        if (typeof item === 'undefined' ||\n            item.length <= 0 ||\n            Object.keys(item).length <= 0) {\n            return false;\n        }\n        Object.keys(filter).forEach(function (key) {\n            var filterValue = filter[key]; // e.g. 'archaeology'\n            // need to find a matching item object key in case of case differences\n            var itemKey = Object.keys(item).find(function (thisKey) { return thisKey.toLowerCase().trim() === key.toLowerCase().trim(); });\n            var itemValue = item[itemKey]; // e.g. 'department' or 'undefined'\n            filterMatches.push(matchValues(itemValue, filterValue, options.matching || 'loose'));\n        });\n        if (options.operator === 'or') {\n            addRow = filterMatches.some(function (match) { return match === true; });\n        }\n        if (options.operator === 'and') {\n            addRow = filterMatches.every(function (match) { return match === true; });\n        }\n        return addRow;\n    });\n}\nfunction processGSheetResults(JSONResponse, returnAllResults, filter, filterOptions) {\n    var data = JSONResponse.values;\n    var startRow = 1; // skip the header row(1), don't need it\n    var processedResults = [{}];\n    var colNames = {};\n    for (var i = 0; i < data.length; i++) {\n        // Rows\n        var thisRow = data[i];\n        for (var j = 0; j < thisRow.length; j++) {\n            // Columns/cells\n            var cellValue = thisRow[j];\n            var colNameToAdd = colNames[j]; // this will be undefined on the first pass\n            if (i < startRow) {\n                colNames[j] = cellValue;\n                continue; // skip the header row\n            }\n            if (typeof processedResults[i] === 'undefined') {\n                processedResults[i] = {};\n            }\n            if (typeof colNameToAdd !== 'undefined' && colNameToAdd.length > 0) {\n                processedResults[i][colNameToAdd] = cellValue;\n            }\n        }\n    }\n    // make sure we're only returning valid, filled data items\n    processedResults = processedResults.filter(function (result) { return Object.keys(result).length; });\n    // if we're not filtering, then return all results\n    if (returnAllResults || !filter) {\n        return processedResults;\n    }\n    return filterResults(processedResults, filter, filterOptions);\n}\nvar gsheetProcessor = function (options, callback, onError) {\n    var apiKey = options.apiKey, sheetId = options.sheetId, sheetName = options.sheetName, sheetNumber = options.sheetNumber, returnAllResults = options.returnAllResults, filter = options.filter, filterOptions = options.filterOptions;\n    if (!options.apiKey || options.apiKey === undefined) {\n        throw new Error('Missing Sheets API key');\n    }\n    return (0, gsheetsapi_js_1.default)({\n        apiKey: apiKey,\n        sheetId: sheetId,\n        sheetName: sheetName,\n        sheetNumber: sheetNumber\n    })\n        .then(function (result) {\n        var filteredResults = processGSheetResults(result, returnAllResults || false, filter || false, filterOptions || {\n            operator: 'or',\n            matching: 'loose'\n        });\n        callback(filteredResults);\n    })\n        .catch(function (err) { return onError(err.message); });\n};\nexports.default = gsheetProcessor;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}